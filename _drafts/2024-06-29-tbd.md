---
title: Dumbing down the Levoit LV-PUR131S Smart Air Purifier
tags: electronics
---

The [Levoit LV-PUR131S Smart Air Purifier][levoit] is a [HEPA] filter (plus a carbon filter) with a particulate matter (PM) sensor and proprietary WiFi-based cloud connectivity. It's a pretty reasonable air filter I use for my living room to help manage the indoor air quality. The replacement filters aren't super expensive and the filter mostly just does its jobâ€¦ Until it doesn't.

I've owned two of these units and both appear to have a flaw in their ability to handle AC power fluctuations. My first unit died about two years ago, but was just within the warranty period. To Levoit's credit, they simply sent me a replacement unit that arrived very quickly and they didn't want the broken unit returned to them. I enjoy a good teardown, so I got to work and found a pleasantly-engineered box. Nearly all the screws were the same type, the components were isolated in a way that were obviously optimized for assembly, and the "smart" bits of the unit were all semi-commodity hardware.

I found the following usable components:

- Espressif ESP-12F microcontroller as the brains of the unit (with WiFi connectivity)
- Cubic PM1003 particulate matter sensor
- Guangdong Welling brushless 24V DC motor with PWM controller
- A nice momentary roller switch
- A nice turbine

Aside from writing a library to connect to the [Cubic PM1003][cubic-pm1003] sensor, I added the components to my collection and didn't think much of them for a couple years. Then I had a brownout and the replacement unit died the same death.

I contacted Levoit support, but their answer this time was that the unit was (well) beyond its 2-year warranty and there were no repair options offered. Unfortunately, I had recently stocked up on about a year's worth of filters. I was already familiar with the guts of this unit, and I had a small [Adafruit QT Py][qt-py] microcontroller I wanted to tinker with, so I decided to see what I could do.

Over the 4 total years of using this unit, I stopped using the "auto" fan control that used the PM sensor. I just left it on medium or high, depending on whether I'd cooked something smokey. The "VeSync" cloud integration was an annoying proprietary "smart home" app that was more advertizing than useful controller. Plus, there was no local-only option for use with HomeKit, so I didn't mind giving this up. I really just wanted a button to pick a fan speed or turn the unit off. I didn't even care about the capacitive touch panel on the top of the unit.

[levoit]: https://levoit.com/products/lv-pur131s-wifi-air-purifier
[hepa]: https://en.wikipedia.org/wiki/HEPA
[cubic-pm1003]: https://github.com/go-sensors/cubicpm1003
[qt-py]: https://www.adafruit.com/product/4600

# Outline

- What is it?
  - HEPA filter
  - PM sensor
  - Wifi-based proprietary cloud integration
- What happened?
  - Power fluctuations, probably?
  - First purifier died within warranty period
    - Disassembled and found a bunch of semi-commodity parts
      - Cubic PM1003 sensor
      - ESP-12-F microcontroller
      - Guangdong Welling brushless DC motor with PWM controller
      - Nice turbine
    - Wrote a driver for PM1003 sensor
  - Second purifier died well after warranty period
- Why not just buy another unit?
  - Still have about a year's worth of filters for the unit
  - I got familiar with the components after the first disassembly
  - I had a small QT Py microcontroller I wanted to tinker with
- Where to go from here?
  - Stopped using the PM sensor-based fan control; only using med-to-high options
  - Cloud integration was mid; didn't integrate with the rest of my HomeKit infra
  - Just want a button to control the fan; don't need any other IoT/"smart" features
  - Don't care about the capacitive touch panel on the unit; would prefer a physical button
- Learning
  - IANAEE
  - Learning about Schottky diodes and motors becoming generators
    - Tried to power both a buck converter and the motor on the same 24V circuit
    - Powered up the motor to full speed by connecting PWM to V+
    - Powered down the motor by connecting PMM to GND
    - Motor became a generator and fed a spike of electricity into the circuit, exceeding the buck converter's limits and releasing the magic smoke
    - Learned why EEs use Schottky diodes!
    - Also threw in a "slower" flyback diode across the V+ and GND of the motor, but I'm not 100% it's necessary
  - Light CircuitPython programming
    - The QT Py is supported by CircuitPython, so I was already familiar with how to interact with GPIO and PWM through the CP libraries
    - The QT Py also has a nice Neopixel RGB LED, so I made use of it as a visual indicator of fan speed
  - Learning about the motor's power consumption
    - Once I got the PWM signal from the microcontroller into the motor's controller, I noticed that the power consumption was tipping just over 1.5A, which is the total limit of the power supply I intend to use
    - The motor appears to be capable of higher speeds than the OEM microcontroller permitted
    - I programmed a limiter to 2/3 of the motor's max speed, which appears to consume 0.67A with the HEPA filters installed
- Circuit board layout
  - After breadboarding the circuit, I grabbed a "perma-proto" breadboard and spend some time carefully bending solid core wire to route power around
    - Even though it will be hidden from view, I'll know it looks nice
  - Tried to keep the motor's power isolated from the "clean" power supply
  - Used screw terminals for power supply IN and motor OUT connections
    - Salvaged from relay assemblies
  - Used headers to allow removing/replacing the microcontroller and buck converter (for if/when I want to salvage this in the future)
- Next steps
  - Install Mean Well power supply
  - Route cables
  - Install physical switch
  - Use it!
